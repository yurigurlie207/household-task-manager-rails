
<%= form_for @task do |f| %>
    <% if @task.errors.any? %>
    <div id="error_explanation">
      <h2>There were some errors:</h2>
      <ul>
        <% @task.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

    <%= f.label :title %>
    <%= f.text_field :title %><br>

    <%= f.label :deadline %>
    <%= f.date_field :deadline %><br>

    <%= f.label :notes %>
    <%= f.text_area :notes %><br>
    
    <% if request.env['PATH_INFO'] =~ /.*new.*/ %>
        <p>Create at least One Subtask for this task</p>
        
            <%= f.fields_for :subtasks do |subtask_builder| %>
                
                <% if subtask_builder.errors.any? %>
                <div id="error_explanation">
                  <h2>There were some errors:</h2>
                  <ul>
                    <% subtask_builder.errors.full_messages.each do |message| %>
                      <li><%= message %></li>
                    <% end %>
                  </ul>
                </div>
              <% end %>

                <%= subtask_builder.label :title %>
                <%= subtask_builder.text_field :title %>

                <h4>Assign at least One Household Member to Subtask</h4>
                <%= subtask_builder.collection_check_boxes :user_ids, User.all, :id, :username %>

            <% end %>
    <% end %>


    <br><br>
  

    <%= f.submit %>

<% end %>